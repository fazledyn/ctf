from Crypto.Util.number import *
from Crypto.PublicKey import RSA
from Crypto.Cipher import PKCS1_v1_5

import sys


e = 61003655186480724454829921788526389077777559461129472887648026991874662662709992005448448263550620427867972157667017181735940414300760008715988220599643364108971958254742287245400224227390343548399494282370609177380155881143231339647767891366270164063486744467395174042825343086650844118593157481789707428603
n = 83232624828177792595616071377000807648193740704003684702730106564705021966450976897666830287374129971840360282835980341277400234100463758607909646621886048089944598200834251938747443355141622459640087876451827639037621380831740452076690631846801487196146179117278789029593215859339250310335337950643729590909
c = 0x1344cb745549db656e82fa5d26aba32ef5df5e51db37af2eb2f7e399882e27e85e8c1d5fc1c57c2d4c02dacbfefe6a4cb011683b2a95823cf34b954a9889a4b58a9678c8851533796defe34bd31200670ad1e08daa2044d668881798f2d43c2b947cd0c7a35079acebf3b9630ef556faafc056d51bc55019f81b6161fda07ea1

while True:

    d = getPrime(1 << 8)

    try:
        key = RSA.construct((n, e, d))

        cipher_rsa = PKCS1_v1_5.new(key)
        out = cipher_rsa.decrypt(bytes.fromhex(c))

        print(out)

    except:
        sys.stdout.write("*")
        sys.stdout.flush()

    # m = pow(c, d, n)
    # hex_val = hex(m)[2:]

    # try:
    #     str_flag = bytes.fromhex(hex_val).decode("utf-8")
    #     print(str_flag)

    #     if "Bsides{" in str_flag:
    #         print("HIT!")
    #         print(str_flag)
    # except:
    #     sys.stdout.write("*")
    #     sys.stdout.flush()
